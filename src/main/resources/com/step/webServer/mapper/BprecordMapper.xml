<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.step.webServer.mapper.BprecordMapper">
    <cache-ref namespace="com.step.webServer.mapper" />
    <select id="bpRecords" resultType="map">
        select
               create_datetime AS createDatetime,
               sbp,
               dbp,
               map,
               pulse_rate AS pulseRate,
               meas_state AS measState,
               symptom
        from step.bprecord
        where patient_id = #{patientId}
    </select>
    <select id="bpOverview" resultType="map">
        select DATEDIFF(max(create_datetime), min(create_datetime)) as numMeasDate,
               count(*) as numMeas,
               max(sbp) as maxSbp,
               avg(sbp) as meanSbp,
               max(dbp) as maxDbp,
               avg(dbp) as meanDbp
        from step.bprecord
        where patient_id = #{patientId}
    </select>
    <insert id="insertOneBprecord">
        insert into step.bprecord
            (sbp,
             dbp,
             map,
             pulse_rate,
             meas_state,
             symptom,
             create_datetime,
             patient_id) values
            (
                #{sbp},
                #{dbp},
                #{map},
                #{pulseRate},
                #{measState},
                #{symptom},
                #{createDatetime},
                #{patientId}
            )
    </insert>
</mapper>
